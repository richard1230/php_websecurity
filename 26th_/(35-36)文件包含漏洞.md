[TOC]

## 定义

![]((35-36)文件包含漏洞_files/9788ab2a-a865-497a-8e32-800d50e4fad8.jpg)
某个函数在这个网页里面需要用,在另外一个网页里面也需要用,为了避免在其他网页里面重复编写这个函数,可以把这个函数写在一个单独的文件里面,这样其他文件名使用的时候就可以包含这个文件就可以了!
有时候让决定你要包含什么;用户提交了要包含的文件名字,后台服务器没有对用户提交的文件进行过滤;这样可能会导致包含漏洞;

比如他提供了3个文件让你选择,我偏偏不选择这三个,我选择其他的文件,如果不做过滤;那么可以打开系统里面任何文件,造成包含漏洞;

![]((35-36)文件包含漏洞_files/8fee448e-bc25-4ba2-9be6-092d0b0834eb.jpg)
一般参数是文件名;
`c:\windows\system.ini `这个文件一般在windows系统里面都是存在的,不管是在windows2003,2008,xp,7等；提交这个文件之后,如果能把这个文件显示出来,是不是就证明了这个网站包含这个漏洞;(看任何文件的前提是这个文件都存在!路径也要知道！)

对于linux服务器,可以查看下面这个文件:
`/etc/passwd`

这种类型的文件有好几个,最好是文本类文件,不要是exe文件等;
## 文件包含函数
![]((35-36)文件包含漏洞_files/c261035f-4086-4d0c-8065-ef4b11d1cd34.jpg)


## 漏洞测试与利用
![]((35-36)文件包含漏洞_files/4482ddc4-f643-471f-88bb-b75588352778.jpg)

调至低等级:
![]((35-36)文件包含漏洞_files/34ace7da-79db-40f8-82a9-6263452ef5e3.png)

![]((35-36)文件包含漏洞_files/d5be74ca-df9c-4f89-91d6-10922b504b85.png)

![]((35-36)文件包含漏洞_files/590f0cb4-4f20-4a0f-a94d-b8e912cfbbcf.png)

![]((35-36)文件包含漏洞_files/0f4189a3-98c7-4a46-9c8c-8e3bc2120ae3.png)
上面为文件里面的内容!

1.可以通过这种漏洞来查看敏感文件;
2.配合文件上传！
## 看敏感文件
1的示例:
想要查看text1.txt里面的内容:
![]((35-36)文件包含漏洞_files/fac7c6be-b182-4d73-b908-f02004019a8a.png)

![]((35-36)文件包含漏洞_files/08f73372-42e8-4eca-b6cb-c38b0bbde7df.jpg)

![]((35-36)文件包含漏洞_files/eec81a38-caeb-4c53-922d-fe56a7aa8a93.png)

这个文件就是在当前目录下面的，那么如果是在下面这个目录下面呢?
![]((35-36)文件包含漏洞_files/c7eb530d-b08a-4387-b88e-fffe0769a046.png)

有可能你会知道它的url,但是很难知道其具体的物理路径;

![]((35-36)文件包含漏洞_files/30e1d84b-ab6e-46b0-94e5-2c096644f8c2.jpg)

![]((35-36)文件包含漏洞_files/964e08e6-4d6f-4207-a9df-47231ad8c91a.png)
这里用的是相对路径的写法;
![]((35-36)文件包含漏洞_files/8a16da76-30a0-4fe2-8b85-157fc25f91d6.jpg)
![]((35-36)文件包含漏洞_files/957dd9ef-f751-4735-a8c4-48ec63be7c01.jpg)
`../../../../Apache2.2/logs/error.log`

![]((35-36)文件包含漏洞_files/a0f479da-9878-49b3-bf83-fcfbd8aec7ff.png)

## 文件包含配合文件上传
36讲了:
很多网站提供文件上传功能,但是一般都做了限制,只让你上传图片,如果有文件包含漏洞的话,是可以执行图片里面的代码的,可以把一句话木马保存为图片文件上传,而后通过包含漏洞去执行图片里面的代码,因为php有一个解析漏洞;

![]((35-36)文件包含漏洞_files/8acf4f64-44da-463a-ba0c-fefe6f97c90d.jpg)
(2'左右)
